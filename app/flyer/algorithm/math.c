/******************************************************************************
 *
 * 文件名  ： math.c
 * 负责人  ： 彭鹏(pengpeng@fiberhome.com)
 * 创建日期： 20150116 
 * 版本号  ： v1.0
 * 文件描述： 数学库
 * 版权说明： Copyright (c) 2000-2020 GNU
 * 其    他： 无
 * 修改日志： 无
 *
 *******************************************************************************/


/*---------------------------------- 预处理区 ---------------------------------*/

/************************************ 头文件 ***********************************/
#include "algorithm.h"

/*----------------------------------- 声明区 ----------------------------------*/

/********************************** 变量声明区 *********************************/


/********************************** 函数声明区 *********************************/


/********************************** 变量实现区 *********************************/


/********************************** 函数实现区 *********************************/
/*******************************************************************************
 *
 * 函数名  : inv_sqrt
 * 负责人  : 彭鹏
 * 创建日期: 20150729
 * 函数功能: 求平方根倒数 
 *
 * 输入参数: 待求的值
 *
 * 输出参数: 无
 *
 * 返回值:   x 的平方根倒数
 * 调用关系: 无
 * 其 它:    http://www.matrix67.com/data/InvSqrt.pdf
 *
 ******************************************************************************/
float inv_sqrt(float x)
{
    if(0 == x) /* 不得为零 */
    {
        return 0;
    }

    float xhalf = 0.5f * x;
    int i = *(int*)&x;          // get bits for floating value
    i =  0x5f375a86 - (i>>1);   // gives initial guess
    x = *(float*)&i;            // convert bits back to float
    x = x * (1.5f - xhalf*x*x); // Newton step
    return x;
}

/*******************************************************************************
 *
 * 函数名  : angle2arc
 * 负责人  : 彭鹏
 * 创建日期: 20150729
 * 函数功能: 角度转弧度
 *
 * 输入参数: 待转的角度
 * 输出参数: 无
 *
 * 返回值:   弧度
 * 调用关系: 无
 * 其 它:    无
 *
 ******************************************************************************/
inline float angle2arc(float x)
{
    return CMOS_ANGLE_ARC_RATE * x;
}

/*******************************************************************************
 *
 * 函数名  : arc2angle
 * 负责人  : 彭鹏
 * 创建日期: 20150729
 * 函数功能: 弧度转角度
 *
 * 输入参数: 待转的弧度
 * 输出参数: 无
 *
 * 返回值:   角度
 * 调用关系: 无
 * 其 它:    无
 *
 ******************************************************************************/
inline float arc2angle(float x)
{
    return CMOS_ARC_ANGLE_RATE * x;
}

